name: CICD with github actions

on:
  workflow_run:
    workflows: Build and push Odoo image
    types: completed 

jobs:
  deploy:
    runs-on: self-hosted
    steps:
       - name: Login to github
         uses: action/login-action@v2
         with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOCKEN}}
       
       - name: Copy addon directory (on EC2)
         run: cp -r ./addons odoo/odoo/addons/

       - name: Pull Latest Changes
         run: git pull origin main
       
       - name: Start Odoo service (on EC2)
         run: sudo systemctl start odoo
